<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="PragmaticScala">
<meta name="generator" content="Paradox, paradox-material-theme=0.4.0, mkdocs-material=2.2.2">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.language" content="">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="PragmaticScala">
<link rel="shortcut icon" href="../assets/images/favicon.png">
<title>第4章——善用对象 · </title>
<link rel="stylesheet" href="../assets/stylesheets/application.7a4cdee3.css">
<link rel="stylesheet" href="../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../lib/prettify/prettify.css">
<script src="../lib/modernizr/modernizr.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
<label class="md-overlay" data-md-component="overlay" for="drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../index.html" title="" class="md-header-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
</span>
<span class="md-header-nav__topic">
第4章——善用对象
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="search"></label>
<div class="md-search__inner">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
<label class="md-icon md-search__icon" for="search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<span class="md-nav__button md-logo">
<i class="md-icon">local_library</i>
</span>
<a href="../index.html" title="">
</a>
</label>
<ul>
  <li><a href="../contents.html" class="page">目录</a>
  <ul>
    <li><a href="../chapter-01/index.html" class="page">第1章——探索Scala</a></li>
    <li><a href="../chapter-02/index.html" class="page">第2章——体验Scala</a></li>
    <li><a href="../chapter-03/index.html" class="page">第3章——从Java到Scala</a></li>
    <li><a href="../chapter-04/index.html" class="active page">第4章——善用对象</a></li>
    <li><a href="../chapter-05/index.html" class="page">第5章——善用类型</a></li>
    <li><a href="../chapter-06/index.html" class="page">第6章——函数值和闭包</a></li>
    <li><a href="../chapter-07/index.html" class="page">第7章——特质</a></li>
    <li><a href="../chapter-08/index.html" class="page">第8章——集合</a></li>
    <li><a href="../chapter-09/index.html" class="page">第9章——模式匹配和正则表达式</a></li>
    <li><a href="../chapter-10/index.html" class="page">第10章——处理异常</a></li>
    <li><a href="../chapter-11/index.html" class="page">第11章——递归编程</a></li>
    <li><a href="../chapter-12/index.html" class="page">第12章——惰性求值和并行集合</a></li>
    <li><a href="../chapter-13/index.html" class="page">第13章——使用Actor模型处理并发</a></li>
    <li><a href="../chapter-14/index.html" class="page">第14章——和Java进行互操作</a></li>
    <li><a href="../chapter-15/index.html" class="page">第15章——使用Scala创建应用程序</a></li>
    <li><a href="../chapter-16/index.html" class="page">第16章——单元测试</a></li>
  </ul></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="../chapter-04/index.html#第4章-善用对象" class="header">第4章——善用对象</a>
  <ul>
    <li><a href="../chapter-04/index.html#代码清单4-1" class="header">代码清单4-1</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-2" class="header">代码清单4-2</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-3" class="header">代码清单4-3</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-4" class="header">代码清单4-4</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-5" class="header">代码清单4-5</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-6" class="header">代码清单4-6</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-7" class="header">代码清单4-7</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-8" class="header">代码清单4-8</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-9" class="header">代码清单4-9</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-10" class="header">代码清单4-10</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-11" class="header">代码清单4-11</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-12" class="header">代码清单4-12</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-13" class="header">代码清单4-13</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-14" class="header">代码清单4-14</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-15" class="header">代码清单4-15</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-16" class="header">代码清单4-16</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-17" class="header">代码清单4-17</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-18" class="header">代码清单4-18</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-19" class="header">代码清单4-19</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-20" class="header">代码清单4-20</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-21" class="header">代码清单4-21</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-22" class="header">代码清单4-22</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-23" class="header">代码清单4-23</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-24" class="header">代码清单4-24</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-25" class="header">代码清单4-25</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-26" class="header">代码清单4-26</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-27" class="header">代码清单4-27</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-28" class="header">代码清单4-28</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-29" class="header">代码清单4-29</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-30" class="header">代码清单4-30</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-31" class="header">代码清单4-31</a></li>
  </ul></li>
</ul>
</nav>

<div class="md-nav__title--site md-version" title="Version">
<i class="md-icon">label_outline</i> 1.0
</div>
</nav>

</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="../chapter-04/index.html#第4章-善用对象" class="header">第4章——善用对象</a>
  <ul>
    <li><a href="../chapter-04/index.html#代码清单4-1" class="header">代码清单4-1</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-2" class="header">代码清单4-2</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-3" class="header">代码清单4-3</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-4" class="header">代码清单4-4</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-5" class="header">代码清单4-5</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-6" class="header">代码清单4-6</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-7" class="header">代码清单4-7</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-8" class="header">代码清单4-8</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-9" class="header">代码清单4-9</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-10" class="header">代码清单4-10</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-11" class="header">代码清单4-11</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-12" class="header">代码清单4-12</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-13" class="header">代码清单4-13</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-14" class="header">代码清单4-14</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-15" class="header">代码清单4-15</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-16" class="header">代码清单4-16</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-17" class="header">代码清单4-17</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-18" class="header">代码清单4-18</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-19" class="header">代码清单4-19</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-20" class="header">代码清单4-20</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-21" class="header">代码清单4-21</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-22" class="header">代码清单4-22</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-23" class="header">代码清单4-23</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-24" class="header">代码清单4-24</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-25" class="header">代码清单4-25</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-26" class="header">代码清单4-26</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-27" class="header">代码清单4-27</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-28" class="header">代码清单4-28</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-29" class="header">代码清单4-29</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-30" class="header">代码清单4-30</a></li>
    <li><a href="../chapter-04/index.html#代码清单4-31" class="header">代码清单4-31</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#第4章-善用对象" name="第4章-善用对象" class="anchor"><span class="anchor-link"></span></a>第4章——善用对象</h1>
<h2><a href="#代码清单4-1" name="代码清单4-1" class="anchor"><span class="anchor-link"></span></a>代码清单4-1</h2>
<pre class="prettyprint"><code class="language-java">//Java example
public class Car {
  private final int year;
  private int miles;    
  
  public Car(int yearOfMake) { year = yearOfMake; }
  
  public int getYear() { return year; }
  public int getMiles() { return miles; }
  
  public void drive(int distance) {                   
    miles += Math.abs(distance);
  }
}</code></pre>
<h2><a href="#代码清单4-2" name="代码清单4-2" class="anchor"><span class="anchor-link"></span></a>代码清单4-2</h2>
<pre class="prettyprint"><code class="language-scala">class Car(val year: Int) {
  private var milesDriven: Int = 0

  def miles: Int = milesDriven

  def drive(distance: Int): Unit = {
    milesDriven += Math.abs(distance)
  }
}</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">Car made in year 2015
Miles driven 0
Drive for 10 miles
Miles driven 10</code></pre>
<h2><a href="#代码清单4-3" name="代码清单4-3" class="anchor"><span class="anchor-link"></span></a>代码清单4-3</h2>
<pre class="prettyprint"><code class="language-scala">class CreditCard(val number: Int, var creditLimit: Int)</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">Compiled from &quot;CreditCard.scala&quot;
public class CreditCard {
  private final int number;
  private int creditLimit;
  public int number();
  public int creditLimit();
  public void creditLimit_$eq(int);
  public CreditCard(int, int);
}</code></pre>
<h2><a href="#代码清单4-4" name="代码清单4-4" class="anchor"><span class="anchor-link"></span></a>代码清单4-4</h2>
<pre class="prettyprint"><code class="language-scala">class Construct(param: String) {
  println(s&quot;Creating an instance of Construct with parameter $param&quot;)
}

println(&quot;Let&#39;s create an instance&quot;)
new Construct(&quot;sample&quot;)</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">Let&#39;s create an instance
Creating an instance of Construct with parameter sample</code></pre>
<h2><a href="#代码清单4-5" name="代码清单4-5" class="anchor"><span class="anchor-link"></span></a>代码清单4-5</h2>
<pre class="prettyprint"><code class="language-scala">class Person(val firstName: String, val lastName: String) {
  var position: String = _

  println(s&quot;Creating $toString&quot;)

  def this(firstName: String, lastName: String, positionHeld: String) {
    this(firstName, lastName)
    position = positionHeld
  }
  override def toString: String = {
    s&quot;$firstName $lastName holds $position position&quot;
  }
}

val john = new Person(&quot;John&quot;, &quot;Smith&quot;, &quot;Analyst&quot;)
println(john)
val bill = new Person(&quot;Bill&quot;, &quot;Walker&quot;)
println(bill)</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">Creating John Smith holds null position
John Smith holds Analyst position
Creating Bill Walker holds null position
Bill Walker holds null position</code></pre>
<p><em>反编译结果</em></p>
<pre class="prettyprint"><code class="language-output">private java.lang.String position;
public java.lang.String position();
public void position_$eq(java.lang.String);</code></pre>
<h2><a href="#代码清单4-6" name="代码清单4-6" class="anchor"><span class="anchor-link"></span></a>代码清单4-6</h2>
<pre class="prettyprint"><code class="language-scala">import scala.beans.BeanProperty

class Dude(@BeanProperty val firstName: String, val lastName: String) {
  @BeanProperty var position: String = _
}</code></pre>
<p><em>反编译结果</em></p>
<pre class="prettyprint"><code class="language-output">Compiled from &quot;Dude.scala&quot;
public class Dude {
  private final java.lang.String firstName;
  private final java.lang.String lastName;
  private java.lang.String position;
  public java.lang.String firstName();
  public java.lang.String lastName();
  public java.lang.String position();
  public void position_$eq(java.lang.String);
  public void setPosition(java.lang.String);
  public java.lang.String getFirstName();
  public java.lang.String getPosition();
  public Dude(java.lang.String, java.lang.String);
}</code></pre>
<h2><a href="#代码清单4-7" name="代码清单4-7" class="anchor"><span class="anchor-link"></span></a>代码清单4-7</h2>
<pre class="prettyprint"><code class="language-scala">class PoliceOfficer(val name: String)</code></pre>
<h2><a href="#代码清单4-8" name="代码清单4-8" class="anchor"><span class="anchor-link"></span></a>代码清单4-8</h2>
<pre class="prettyprint"><code class="language-scala">object CopApp extends App {
  type Cop = PoliceOfficer

  val topCop = new Cop(&quot;Jack&quot;)
  println(topCop.getClass)
}</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">class PoliceOfficer</code></pre>
<h2><a href="#代码清单4-9" name="代码清单4-9" class="anchor"><span class="anchor-link"></span></a>代码清单4-9</h2>
<pre class="prettyprint"><code class="language-scala">class Vehicle(val id: Int, val year: Int) {
  override def toString = s&quot;ID: $id Year: $year&quot;
}

class Car(override val id: Int, override val year: Int, var fuelLevel: Int)
  extends Vehicle(id, year) {
  override def toString = s&quot;${super.toString} Fuel Level: $fuelLevel&quot;
}

val car = new Car(1, 2015, 100)
println(car)</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">ID: 1 Year: 2015 Fuel Level: 100</code></pre>
<h2><a href="#代码清单4-10" name="代码清单4-10" class="anchor"><span class="anchor-link"></span></a>代码清单4-10</h2>
<pre class="prettyprint"><code class="language-scala">def echo[T](input1: T, input2: T): Unit =
  println(s&quot;got $input1 (${input1.getClass}) $input2 (${input2.getClass})&quot;)</code></pre>
<h2><a href="#代码清单4-11" name="代码清单4-11" class="anchor"><span class="anchor-link"></span></a>代码清单4-11</h2>
<pre class="prettyprint"><code class="language-scala">echo(&quot;hello&quot;, &quot;there&quot;)
echo(4, 5)</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">got hello (class java.lang.String) there (class java.lang.String)
got 4 (class java.lang.Integer) 5 (class java.lang.Integer)</code></pre>
<h2><a href="#代码清单4-12" name="代码清单4-12" class="anchor"><span class="anchor-link"></span></a>代码清单4-12</h2>
<pre class="prettyprint"><code class="language-scala">echo(&quot;hi&quot;, 5)</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">got hi (class java.lang.String) 5 (class java.lang.Integer)</code></pre>
<h2><a href="#代码清单4-13" name="代码清单4-13" class="anchor"><span class="anchor-link"></span></a>代码清单4-13</h2>
<pre class="prettyprint"><code class="language-scala">echo[Int](&quot;hi&quot;, 5) //error: type mismatch</code></pre>
<h2><a href="#代码清单4-14" name="代码清单4-14" class="anchor"><span class="anchor-link"></span></a>代码清单4-14</h2>
<pre class="prettyprint"><code class="language-scala">def echo2[T1, T2](input1: T1, input2: T2): Unit =
  println(s&quot;received $input1 and $input2&quot;)

echo2(&quot;Hi&quot;, &quot;5&quot;)</code></pre>
<h2><a href="#代码清单4-15" name="代码清单4-15" class="anchor"><span class="anchor-link"></span></a>代码清单4-15</h2>
<pre class="prettyprint"><code class="language-scala">class Message[T](val content: T) {
  override def toString = s&quot;message content is $content&quot;

  def is(value: T): Boolean = value == content
}</code></pre>
<h2><a href="#代码清单4-16" name="代码清单4-16" class="anchor"><span class="anchor-link"></span></a>代码清单4-16</h2>
<pre class="prettyprint"><code class="language-scala">val message1: Message[String] = new Message(&quot;howdy&quot;)
val message2 = new Message(42)

println(message1)
println(message1.is(&quot;howdy&quot;))
println(message1.is(&quot;hi&quot;))
println(message2.is(22))</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">message content is howdy
true
false
false</code></pre>
<h2><a href="#代码清单4-17" name="代码清单4-17" class="anchor"><span class="anchor-link"></span></a>代码清单4-17</h2>
<pre class="prettyprint"><code class="language-scala">message1.is(22) //error: type mismatch</code></pre>
<h2><a href="#代码清单4-18" name="代码清单4-18" class="anchor"><span class="anchor-link"></span></a>代码清单4-18</h2>
<pre class="prettyprint"><code class="language-scala">message2.is(&#39;A&#39;) //No error!</code></pre>
<h2><a href="#代码清单4-19" name="代码清单4-19" class="anchor"><span class="anchor-link"></span></a>代码清单4-19</h2>
<pre class="prettyprint"><code class="language-scala">import scala.collection._

class Marker(val color: String) {
  println(s&quot;Creating ${this}&quot;)

  override def toString = s&quot;marker color $color&quot;
}

object MarkerFactory {
  private val markers = mutable.Map(
    &quot;red&quot; -&gt; new Marker(&quot;red&quot;),
    &quot;blue&quot; -&gt; new Marker(&quot;blue&quot;),
    &quot;yellow&quot; -&gt; new Marker(&quot;yellow&quot;))

  def getMarker(color: String): Marker =
    markers.getOrElseUpdate(color, new Marker(color))
}

println(MarkerFactory getMarker &quot;blue&quot;)
println(MarkerFactory getMarker &quot;blue&quot;)
println(MarkerFactory getMarker &quot;red&quot;)
println(MarkerFactory getMarker &quot;red&quot;)
println(MarkerFactory getMarker &quot;green&quot;)</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">Creating marker color red
Creating marker color blue
Creating marker color yellow
marker color blue
marker color blue
marker color red
marker color red
Creating marker color green
marker color green</code></pre>
<h2><a href="#代码清单4-20" name="代码清单4-20" class="anchor"><span class="anchor-link"></span></a>代码清单4-20</h2>
<pre class="prettyprint"><code class="language-scala">import scala.collection._

class Marker private (val color: String) {
  println(s&quot;Creating ${this}&quot;)

  override def toString = s&quot;marker color $color&quot;
}

object Marker {
  private val markers = mutable.Map(
    &quot;red&quot; -&gt; new Marker(&quot;red&quot;),
    &quot;blue&quot; -&gt; new Marker(&quot;blue&quot;),
    &quot;yellow&quot; -&gt; new Marker(&quot;yellow&quot;))

  def getMarker(color: String): Marker =
    markers.getOrElseUpdate(color, new Marker(color))
}

println(Marker getMarker &quot;blue&quot;)
println(Marker getMarker &quot;blue&quot;)
println(Marker getMarker &quot;red&quot;)
println(Marker getMarker &quot;red&quot;)
println(Marker getMarker &quot;green&quot;)</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">Creating marker color red
Creating marker color blue
Creating marker color yellow
marker color blue
marker color blue
marker color red
marker color red
Creating marker color green
marker color green</code></pre>
<h2><a href="#代码清单4-21" name="代码清单4-21" class="anchor"><span class="anchor-link"></span></a>代码清单4-21</h2>
<pre class="prettyprint"><code class="language-scala">import scala.collection._

class Marker private (val color: String) {
  override def toString = s&quot;marker color $color&quot;
}
object Marker {
  private val markers = mutable.Map(
    &quot;red&quot; -&gt; new Marker(&quot;red&quot;),
    &quot;blue&quot; -&gt; new Marker(&quot;blue&quot;),
    &quot;yellow&quot; -&gt; new Marker(&quot;yellow&quot;))

  def supportedColors: Iterable[String] = markers.keys
  def apply(color: String): Marker = markers.getOrElseUpdate(color, new Marker(color))
}
println(s&quot;Supported colors are : ${Marker.supportedColors}&quot;)
println(Marker(&quot;blue&quot;))
println(Marker(&quot;red&quot;))</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">Creating marker color red
Creating marker color blue
Creating marker color yellow
marker color blue
marker color blue
marker color red
marker color red
Creating marker color green
marker color green</code></pre>
<h2><a href="#代码清单4-22" name="代码清单4-22" class="anchor"><span class="anchor-link"></span></a>代码清单4-22</h2>
<pre class="prettyprint"><code class="language-scala">object Greeter {
  def greet(): Unit = println(&quot;Ahoy, me hearties!&quot;)
}</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">Compiled from &quot;Greeter.scala&quot;
public final class Greeter {
  public static void greet();
}</code></pre>
<h2><a href="#代码清单4-23" name="代码清单4-23" class="anchor"><span class="anchor-link"></span></a>代码清单4-23</h2>
<pre class="prettyprint"><code class="language-scala">package chapter4.finance1.finance.currencies

object Currency extends Enumeration {
  type Currency = Value
  val CNY, GBP, INR, JPY, NOK, PLN, SEK, USD = Value
}</code></pre>
<h2><a href="#代码清单4-24" name="代码清单4-24" class="anchor"><span class="anchor-link"></span></a>代码清单4-24</h2>
<pre class="prettyprint"><code class="language-scala">package chapter4.finance1.finance.currencies

import Currency._

class Money(val amount: Int, val currency: Currency) {
  override def toString = s&quot;$amount $currency&quot;
}</code></pre>
<h2><a href="#代码清单4-25" name="代码清单4-25" class="anchor"><span class="anchor-link"></span></a>代码清单4-25</h2>
<pre class="prettyprint"><code class="language-scala">import chapter4.finance1.finance.currencies.Currency

object UseCurrency extends App {
  Currency.values.foreach { currency ⇒ println(currency) }
}</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">CNY
GBP
INR
JPY
NOK
PLN
SEK
USD</code></pre>
<h2><a href="#代码清单4-26" name="代码清单4-26" class="anchor"><span class="anchor-link"></span></a>代码清单4-26</h2>
<pre class="prettyprint"><code class="language-scala">package chapter4.finance1.finance.currencies

import Currency._

object Converter {
  def convert(money: Money, to: Currency): Money = {
    //fetch current market rate... using mocked value here
    val conversionRate = 2
    new Money(money.amount * conversionRate, to)
  }
}</code></pre>
<h2><a href="#代码清单4-27" name="代码清单4-27" class="anchor"><span class="anchor-link"></span></a>代码清单4-27</h2>
<pre class="prettyprint"><code class="language-scala">package chapter4.finance1.finance.currencies

object Charge {
  def chargeInUSD(money: Money): String = {
    def moneyInUSD = Converter.convert(money, Currency.USD)
    s&quot;charged $$${moneyInUSD.amount}&quot;
  }
}</code></pre>
<h2><a href="#代码清单4-28" name="代码清单4-28" class="anchor"><span class="anchor-link"></span></a>代码清单4-28</h2>
<pre class="prettyprint"><code class="language-scala">import chapter4.finance1.finance.currencies._

object CurrencyApp extends App {
  var moneyInGBP = new Money(10, Currency.GBP)

  println(Charge.chargeInUSD(moneyInGBP))

  println(Converter.convert(moneyInGBP, Currency.USD))
}</code></pre>
<h2><a href="#代码清单4-29" name="代码清单4-29" class="anchor"><span class="anchor-link"></span></a>代码清单4-29</h2>
<pre class="prettyprint"><code class="language-scala">package chapter4.finance2.finance

package object currencies {
  import Currency._

  def convert(money: Money, to: Currency): Money = {
    //fetch current market rate... using mocked value here
    val conversionRate = 2
    new Money(money.amount * conversionRate, to)
  }
}</code></pre>
<h2><a href="#代码清单4-30" name="代码清单4-30" class="anchor"><span class="anchor-link"></span></a>代码清单4-30</h2>
<pre class="prettyprint"><code class="language-scala">package chapter4.finance2.finance.currencies

object Charge {
  def chargeInUSD(money: Money): String = {
    def moneyInUSD = convert(money, Currency.USD)
    s&quot;charged $$${moneyInUSD.amount}&quot;
  }
}</code></pre>
<h2><a href="#代码清单4-31" name="代码清单4-31" class="anchor"><span class="anchor-link"></span></a>代码清单4-31</h2>
<pre class="prettyprint"><code class="language-scala">package chapter4.finance2

import chapter4.finance2.finance.currencies._

object CurrencyApp extends App {
  var moneyInGBP = new Money(10, Currency.GBP)

  println(Charge.chargeInUSD(moneyInGBP))

  println(convert(moneyInGBP, Currency.USD))
}</code></pre>
<p><em>运行结果</em></p>
<pre class="prettyprint"><code class="language-output">CNY
GBP
INR
JPY
NOK
PLN
SEK
USD</code></pre>
</div>
<div>
<a href="https://github.com/ReactivePlatform/Pragmatic-Scala/tree/master/src/paradox/chapter-04/index.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
1.0
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../chapter-03/index.html" title="第3章——从Java到Scala" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
第3章——从Java到Scala
</span>
</div>
</a>
<a href="../chapter-05/index.html" title="第5章——善用类型" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
第5章——善用类型
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="../assets/javascripts/application.5165553b.js"></script>
<script src="../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../."}})</script>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
